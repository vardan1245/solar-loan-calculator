<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>15% Inverter Tolerance Rule Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-case { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .result { margin: 10px 0; padding: 10px; background: #f5f5f5; border-radius: 3px; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; }
        .warning { background: #fff3cd; border: 1px solid #ffeaa7; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; }
        input[type="number"] { padding: 5px; margin: 5px; }
        button { padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer; }
        button:hover { background: #0056b3; }
    </style>
</head>
<body>
    <h1>üîå 15% Inverter Tolerance Rule Test</h1>
    
    <div class="test-case">
        <h3>Test the 15% Rule</h3>
        <p>Enter a system power (kW) to see which inverters would be suitable according to the 15% tolerance rule.</p>
        
        <label for="testSystemPower">System Power (kW):</label>
        <input type="number" id="testSystemPower" value="10" step="0.1" min="0">
        <button onclick="test15PercentRule()">Test Rule</button>
        
        <div id="testResults"></div>
    </div>

    <div class="test-case">
        <h3>How the Corrected 15% Rule Works</h3>
        <p><strong>Formula:</strong> Inverter Power √ó 1.15 ‚â• System Power</p>
        <p><strong>Therefore:</strong> Inverter Power ‚â• System Power √∑ 1.15</p>
        <p><strong>Example:</strong> For a 10 kW system:</p>
        <ul>
            <li>Minimum inverter: 10 √∑ 1.15 = 8.7 kW</li>
            <li>Available options: 10, 12, 15, 20, 25, 30, 40, 50, 60, 75, 100, 110 kW</li>
            <li>Hidden options: 3, 3.6, 5.3, 6, 8 kW (too small to handle 10 kW system)</li>
        </ul>
        
        <div class="result success">
            <strong>‚úÖ Why this rule?</strong>
            <ul>
                <li>Prevents overloading inverters (too small)</li>
                <li>Avoids excessive oversizing (too large)</li>
                <li>Ensures optimal performance and efficiency</li>
                <li>Industry standard practice</li>
            </ul>
        </div>
    </div>

    <div class="test-case">
        <h3>Sample Inverter Database</h3>
        <p>Available inverter powers: 3, 3.6, 5.3, 6, 8, 10, 12, 15, 20, 25, 30, 40, 50, 60, 75, 100, 110 kW</p>
    </div>

    <script>
        // Sample inverter data (matching your actual database)
        const inverters = [
            { kw: 3, brand: 'Sample', model: '3kW' },
            { kw: 3.6, brand: 'Sample', model: '3.6kW' },
            { kw: 5.3, brand: 'Sample', model: '5.3kW' },
            { kw: 6, brand: 'Sample', model: '6kW' },
            { kw: 8, brand: 'Sample', model: '8kW' },
            { kw: 10, brand: 'Sample', model: '10kW' },
            { kw: 12, brand: 'Sample', model: '12kW' },
            { kw: 15, brand: 'Sample', model: '15kW' },
            { kw: 20, brand: 'Sample', model: '20kW' },
            { kw: 25, brand: 'Sample', model: '25kW' },
            { kw: 30, brand: 'Sample', model: '30kW' },
            { kw: 40, brand: 'Sample', model: '40kW' },
            { kw: 50, brand: 'Sample', model: '50kW' },
            { kw: 60, brand: 'Sample', model: '60kW' },
            { kw: 75, brand: 'Sample', model: '75kW' },
            { kw: 100, brand: 'Sample', model: '100kW' },
            { kw: 110, brand: 'Sample', model: '110kW' }
        ];

        function test15PercentRule() {
            const systemPower = parseFloat(document.getElementById('testSystemPower').value);
            const resultsDiv = document.getElementById('testResults');
            
            if (!systemPower || systemPower <= 0) {
                resultsDiv.innerHTML = '<div class="result error">Please enter a valid system power.</div>';
                return;
            }

                        // Calculate minimum power (inverter must be able to handle system power)
            const minPower = systemPower / 1.15;
            
            // Filter suitable inverters (inverters that can handle the system power)
            const suitableInverters = inverters.filter(inv =>
                inv.kw >= minPower
            );
            
            // Filter unsuitable inverters (inverters too small to handle system power)
            const unsuitableInverters = inverters.filter(inv =>
                inv.kw < minPower
            );

            let html = `
                <div class="result success">
                                    <h4>üìä Results for ${systemPower} kW System</h4>
                <p><strong>Minimum Power:</strong> ${minPower.toFixed(2)} kW (inverter must handle system power)</p>
                <p><strong>Rule:</strong> Inverter Power √ó 1.15 ‚â• System Power</p>
                <p><strong>Suitable Inverters:</strong> ${suitableInverters.length} found</p>
                </div>
            `;

            if (suitableInverters.length > 0) {
                html += `
                    <div class="result success">
                        <h4>‚úÖ Suitable Inverters (Within 15% Range)</h4>
                        <ul>
                            ${suitableInverters.map(inv => `<li>${inv.brand} ${inv.model} - ${inv.kw} kW</li>`).join('')}
                        </ul>
                    </div>
                `;
            } else {
                html += `
                    <div class="result warning">
                        <h4>‚ö†Ô∏è No Suitable Inverters Found</h4>
                        <p>No inverters within the 15% tolerance range for ${systemPower} kW system.</p>
                        <p>Consider adjusting system size or checking inverter availability.</p>
                    </div>
                `;
            }

            if (unsuitableInverters.length > 0) {
                html += `
                    <div class="result warning">
                        <h4>‚ùå Unsuitable Inverters (Too Small)</h4>
                        <p><strong>Cannot Handle System Power:</strong> ${unsuitableInverters.map(inv => inv.kw + ' kW').join(', ')}</p>
                        <p><em>Note: Inverters must be ‚â• ${minPower.toFixed(2)} kW to handle ${systemPower} kW system</em></p>
                    </div>
                `;
            }

            resultsDiv.innerHTML = html;
        }

        // Test on page load
        window.onload = function() {
            test15PercentRule();
        };
    </script>
</body>
</html>
